# 仕様

報酬とは、給与や賞与,手当など、月毎に発生する収入を指す。

## ドメインモデル

financierでは、報酬を定義と実績とに分けて扱う。
それぞれ**報酬定義 _IncomeDefinition_**, **報酬実績 _IncomeRecord_** と呼称する。

### 報酬定義

報酬定義は種別、値、期間、そして課税フラグをもつ。

報酬は以下の種類が存在する:

- **絶対値** `absolute`: 毎月定数的に発生するもの

期間は月単位で設定される。
給与は年度末のタイミングで変更されるが、通勤手当は就業規則の改訂に伴って変更される。
このような非同期的な変更に対応するため、定義ごとにその期間を保持する。

ここで、報酬は厚生年金保険料等の課税対象になる場合とならない場合がある。
これはユーザが登録する定義により異なるため、定義ごとに課税フラグとして保持する。

### 報酬実績

報酬定義はある月と定義に基づいて計算される。
種別が `絶対値` であればその値が、`相対値`であれば値に月度の勤務日数を乗じたものがそれぞれ実績として計算される。

実績値は月毎に自動計算されるが、システムの計算に問題がある場合を考慮し、ユーザが値を指定できるようにする。

## 提供する機能

定義の作成・更新・参照および実績の参照・更新・削除(自動計算に戻す)機能を提供する。
定義の削除は実績の管理が大変になるため、現状では提供しないものとする。

### 定義の作成

報酬定義を作成する際は以下に示す値を渡す。

- 名称
- 種別
- 値
- 課税フラグ
- 有効期間

有効期間の単位は会計月度とする。開始月初から終了月末までを有効期間とする。

### 定義の更新

既存の報酬定義はいつでもその内容を変更することができる。
変更の履歴は保持されない。

### 定義の参照

報酬定義は以下に示す条件でクエリできる。

- 種別
- 期間: 以下のいずれかを選択する。
  - 単月: 有効期間にその月が含まれる定義を取得する。
  - 範囲: ある期間がその有効期間と重なる定義を取得する。

### 実績の参照

報酬定義に基づいて計算された実績値を参照できる。

### 実績の更新

計算された実績値に問題がある場合、ユーザは手動で値を更新することができる。
実績の登録後に定義の有効期間が変更され、実績が有効期間から外れた場合、その実績は削除される。

### 実績の削除(自動計算に戻す)

ユーザが手動で更新した実績値を削除し、システムによる自動計算値に戻すことができる。
