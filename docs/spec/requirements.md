# 要求仕様書

**プロジェクト名**: financier（個人財務マネジメントシステム）
**最終更新日**: 2026-02-15

---

## 1. 目的・概要

本システムは、単一ユーザが自身の財務状況を把握し、意思決定を行うための Web ベースの家計管理システムである。

日々の収支記録を主軸とし、年度単位での予算管理・カテゴリ別分析・積立状況の可視化を通じて、利用者の財務意思決定を支援する。

### 設計思想

- 本システムは **完全会計システムではない**
- 本システムは **財務統制システムでもない**
- 本システムは **意思決定支援システム** である

構造原則:

- 年度は予算の境界である
- 財務は連続体である
- 積立は将来支出への意思表示である
- 予算は目安であり、強制力を持たない
- 残高は派生値である

## 2. 利用者・前提条件

| 項目           | 内容                         |
| -------------- | ---------------------------- |
| 利用者         | 単一ユーザ                   |
| 利用形態       | Web アプリケーション         |
| 通貨           | 日本円（JPY）固定            |
| データ保存     | クラウド                     |
| 外部連携       | 行わない                     |
| エクスポート   | 対象外                       |
| 入力方式       | 手入力（自動取得は行わない） |

## 3. システムの基本概念

本システムは以下の概念で構成される。

### 3.1 トランザクション

収入または支出の記録単位。日々の収支はすべてトランザクションとして記録される。

### 3.2 カテゴリ

トランザクションを分類するための概念。収入カテゴリと支出カテゴリの2種別を持つ。年度に依存しないシステム共通の概念である。

### 3.3 年度

会計の区切りとなる期間。4月1日〜翌年3月31日を1年度とする。予算管理の境界として機能する。

### 3.4 予算

年度×カテゴリ単位で設定される金額の目安。強制力は持たず、実績との差分を可視化するために使用する。

※ 予算実績の集計には、未来日のトランザクションを含めない。当該日に到達した時点で実績に反映される。

### 3.5 積立定義

将来の支出に備えて資金を確保するための仕組み。支出カテゴリと 0..1 : 1 の関係を持つ独立したエンティティである。積立への拠出は、紐づくカテゴリへの通常の支出トランザクションとして記録する。取り崩し時には支出トランザクションを生成せず、取り崩し履歴（SavingWithdrawal）として記録する。積立残高は永続保存せず、拠出トランザクションと取り崩し履歴から常に集計で算出する。

積立定義は、支出カテゴリ作成時に積立として作成する場合のみ作成可能とし、カテゴリ作成後に積立化の可否を変更することはできない。

### 3.6 イベント

トランザクションを横断的にグルーピングするための概念。旅行・給与一式など、目的単位で取引を束ねる。年度を跨いで利用できる。

### 3.7 イベントテンプレート

繰り返し発生するイベント（給与入力・旅行パターンなど）のテンプレート。一括登録の元データとなる。

### 3.8 内部残高

全期間の収入合計と支出合計の差分から算出される派生値。利用者の「財政体力」を示す指標であり、ドメインレベルの仮想的な概念である。実口座残高との一致は保証しない。

```
内部残高 = 全期間の収入合計 − 全期間の支出合計（積立カテゴリを含む）
```

※ 未来日のトランザクションは算出対象に含めない。

## 4. 解決する課題

| 課題                           | 本システムによる解決                               |
| ------------------------------ | -------------------------------------------------- |
| 年間の収支把握が困難           | 年度単位での予算管理と実績可視化                   |
| カテゴリ別の支出傾向がわからない | カテゴリ別集計・構成比表示                         |
| 将来の大きな支出に備えたい     | 積立定義による計画的な資金確保と進捗管理           |
| 特定目的の支出総額を知りたい   | イベントによる横断的集計                           |
| 予算と実績の乖離に気づけない   | 差分の常時可視化と警告表示                         |
| 自分の財政体力が把握できない   | 内部残高による全期間の資産状況表示                 |

## 5. 制約思想

本システムは利用者の行動を制限しない。

- 入力を強制停止 **しない**
- 予算超過を禁止 **しない**
- 積立不足を禁止 **しない**

その代わりに以下を行う:

- 常時可視化
- 警告表示
- 差分明示

## 6. 非機能要件

- Web アプリケーションとして提供する
- クラウド上にデータを永続化する
- 単一ユーザ前提のため、権限管理は最小限とする
- パフォーマンス要件は個人利用レベルを想定する

## 7. スコープ外

以下は本システムの対象範囲に含めない。

- 銀行・クレジットカード連携
- CSV 等のデータエクスポート
- 複数ユーザ・家族共有機能
- 高度な予測・分析機能（AI による支出予測など）
- 実口座残高との同期・照合
- 月次上限管理（月は表示フィルタ・集計軸としてのみ使用）
- 予算の自動調整・実績からの自動算出
