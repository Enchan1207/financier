# 3. カテゴリ（Category）

- 索引: [機能仕様書](../functions.md)
- 関連要件: [要求仕様書](../requirements.md)
- 関連ユースケース: [ユースケース定義書](../usecases.md)

---

## 3.1 定義

トランザクションを分類するためのラベル。年度に依存せずシステム全体で共通。

## 3.2 属性

| 属性名 | 型                | 必須 | 説明                        |
| ------ | ----------------- | ---- | --------------------------- |
| id     | ID                | ○    | 一意識別子                  |
| name   | 文字列            | ○    | カテゴリ名                  |
| type   | income / expense  | ○    | カテゴリ種別                |
| status | active / archived | ○    | 利用状態（有効/削除済み）   |

## 3.3 仕様

- 階層構造は持たない（フラット）
- ユーザによる追加・編集が可能
- `status` は `active` / `archived` を取る
- `archived` のカテゴリは新規トランザクション作成・編集時の選択肢に表示しない
- `archived` のカテゴリへの新規指定・変更を伴うトランザクション登録・更新は業務ルール違反として拒否する
- 既存トランザクションが `archived` のカテゴリを参照している場合、カテゴリ変更なしの更新は許可する
- 既存トランザクション・予算の参照先としては保持する（履歴保全）
- カテゴリ削除は物理削除とし、トランザクション・予算・積立定義の参照がすべて 0 件の場合のみ許可する
- カテゴリ種別（income / expense）は作成時に決定し、変更不可
- 支出カテゴリ作成時には「積立として作成する」を選択できる
- 積立として作成するかどうかはカテゴリ作成時にのみ決定でき、作成後は変更不可
- カテゴリ自体にはメタデータを持たせない（積立情報等は積立定義エンティティが保持）
- 積立定義が紐づくカテゴリは UI 上「積立カテゴリ」として扱う
- 積立カテゴリの削除時に積立専用の追加確認・追加警告は行わない

---
