# 3. 予算系

- 索引: [ユースケース定義書](../usecases.md)
- 関連機能: [機能仕様書](../functions.md)
- 関連要件: [要求仕様書](../requirements.md)

---

## UC-3.1 年度予算の作成

**概要**: 新年度の予算を作成する。

**事前条件**:

- 対象年度が active 状態である
- 対象年度が未生成の場合は active 相当として扱い、初回保存時に年度レコードを生成する

**基本フロー**:

1. 利用者が対象年度を指定する
2. カテゴリごとに予算額を設定する
3. 保存する

**代替フロー**:

- 2a. 前年度の予算設定をコピーして、それを基に調整する

**事後条件**:

- 年度×カテゴリ単位の予算が保存される

---

## UC-3.2 カテゴリ予算の設定・変更

**概要**: 特定年度・カテゴリの予算額を設定または変更する。

**事前条件**:

- 対象年度が active 状態である
- 対象年度が未生成の場合は active 相当として扱い、初回保存時に年度レコードを生成する

**基本フロー**:

1. 利用者が年度とカテゴリを選択する
2. 予算額を入力する（直接入力、または予算定義ヘルパを使用）
3. 保存する

**予算定義ヘルパ**:

- 月額固定: 月額 × 12 で年額を算出
- 月ごと変動: 各月の金額を入力し合算

**システム動作**:

- 支出予算合計が収入予算合計を超える場合、警告を表示する
- 操作自体は制限しない

---

## UC-3.3 予算の再配分

**概要**: 既存の予算を複数カテゴリ間で再配分する。

**事前条件**:

- 対象年度が active 状態である
- 対象年度が未生成の場合は active 相当として扱い、初回保存時に年度レコードを生成する

**基本フロー**:

1. 利用者が再配分元のカテゴリと減額幅を指定する
2. 再配分先のカテゴリと増額幅を指定する
3. 差分を確認する
4. 保存する

**システム動作**:

- 再配分前後の差分を表示する
- 強制制約なし、警告のみ

---

## UC-3.4 年度予算実績の確認

**概要**: 年度の予算に対する実績と差分を確認する。

**基本フロー**:

1. 利用者が対象年度を選択する
2. カテゴリ別に予算・実績・差分が表示される

**システム動作**:

- 予算超過も含めてそのまま表示する（制限しない）

---
