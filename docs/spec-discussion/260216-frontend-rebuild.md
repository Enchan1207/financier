# フロントエンド UI 再設計：ホーム中心型への転換

**日付**: 2026-02-16  
**ブランチ**: `feature/redesign-home-ui`  
**コミット**: e8d99a0

---

## 背景：発覚した問題

モックデータを用いた初期実装により、以下の問題が顕在化した：

### 1. 「SaaS管理画面」のような手触り

すべての機能が同列にサイドバーに並んでいたため、以下のような状態になっていた：

```
サイドバー（旧構成）
 ├── ダッシュボード
 ├── 取引
 ├── カテゴリ（支出 / 収入）
 ├── 予算
 ├── 積立
 ├── イベント
 └── 分析
```

- 7つのメニュー項目が常に並び、「今日はどこを触ればいいんだ？」と迷う
- 日常的な操作と設定系の操作が区別されていない
- ダッシュボードがリンク集になっており、中継点に過ぎない存在

### 2. 本来の設計思想とのズレ

要求仕様書（[requirements/01-purpose-overview.md](../spec/requirements/01-purpose-overview.md)）で定義されているfinancierの本質：

> 本システムは **意思決定支援システム** である

しかし、実装されたUIは「すべての機能を同列に並べた管理ツール」になっており、以下の点で設計思想とズレていた：

- **日常の操作が明確でない**: 予算や積立は年度初めに設定するものだが、毎日使う「取引登録」と同じレベルで並んでいる
- **支出登録の動線が長い**: 最頻操作である支出登録が、ダイアログを開く→フォーム入力という2ステップ必要
- **意思決定に必要な情報が分散**: 残高、当月支出、予算進捗などが別々のページに散らばっている

---

## 利用頻度による操作の分類

実際のユースケースを分析すると、操作は明確に3層に分かれる：

| 頻度 | 操作 | タイミング | 例 |
|------|------|-----------|-----|
| **毎日〜数日に1回** | 支出の登録、残高の確認 | 日常 | コンビニで買い物、スーパーで食材購入 |
| **月1回程度** | 収入の登録、積立進捗の確認、予算との乖離チェック | 給料日・月末 | 給与入力、積立状況確認 |
| **年数回 or 初期設定** | カテゴリ作成/編集、予算設定、イベント管理、年度締め | 年度初め・特別なとき | 新カテゴリ追加、年間予算策定 |

従来のUIは、この3層を区別せず全部フラットに並べていたため、「管理画面」感が出ていた。

---

## 修正方針

### コンセプト: 「ホームを日常操作のハブにする」

日常的に行う操作（支出登録・残高確認・予算確認）をホーム画面に集約し、1画面で完結できるようにする。

### 設計原則

| 原則 | 具体策 |
|------|--------|
| **日常操作を最短動線にする** | ホーム画面にインライン支出登録を置く |
| **見たい情報がすぐ見える** | 残高・当月支出・予算消化率をホームに集約 |
| **管理系は必要なときだけ** | サイドバーで「管理」グループとして分離 |
| **情報の重複を減らす** | ダッシュボードの「各画面へのリンクカード」は不要に |

---

## 実装内容

### 1. ホーム画面の再設計

**ファイル**: `packages/app/frontend/routes/dashboard/index.tsx`

#### 変更前（ダッシュボード）

- 3枚のサマリカード（内部残高、積立残高、未来日取引）
- 年度収支サマリカード
- 主要画面へのリンクカード

#### 変更後（ホーム）

```
┌─────────────────────────────────────────────┐
│  ホーム                                      │
├─────────────────────────────────────────────┤
│  ■ 内部残高  ¥1,234,567   ■ 今月の支出 ¥45,000│
│                                             │
│  ┌─ 支出を記録 ────────────────────────┐   │
│  │ [カテゴリ▼] [金額] [名前] [登録]       │   │
│  └────────────────────────────────────┘   │
│                                             │
│  ── 最近の取引 ────────────────────────   │
│  2/16  食費   ¥1,200  スーパー             │
│  2/15  交通費 ¥500    バス                 │
│                      [すべての取引を見る →] │
│                                             │
│  ── 今月の予算 ────────────────────────   │
│  食費     ████████░░  ¥32,000 / ¥40,000    │
│  交通費   ██░░░░░░░░  ¥5,000 / ¥15,000     │
│                          [予算設定 →]       │
└─────────────────────────────────────────────┘
```

**特徴**:

- **インライン支出登録**: カテゴリ・金額・名前だけで登録可能（日付は自動で今日）
- **簡潔な残高サマリ**: 最重要な2つの数値に絞り込み
- **最近の取引5件**: 直近の入力内容をすぐ確認
- **予算進捗バー**: 視覚的に進捗を把握（80%以上で黄色、超過で赤）

### 2. サイドバーの3層構造化

**ファイル**: `packages/app/frontend/components/layout/app-sidebar.tsx`

```
サイドバー（新構成）
  日常操作（グループラベルなし）
    ├── ホーム           ← 日常操作の起点
    └── 取引一覧         ← 全件閲覧・検索

  ───────────────────

  管理（月1回程度）
    ├── カテゴリ
    │     ├── 支出
    │     └── 収入
    ├── 予算
    ├── 積立
    └── イベント

  ───────────────────

  分析（見たいときだけ）
    └── 分析
```

**変更点**:

- 日常操作（ホーム・取引一覧）をトップに配置、グループラベルなしで即アクセス可能に
- 管理系を「管理」グループで明示的に分離
- 分析を独立したグループとして配置

### 3. 新規コンポーネント

#### QuickExpenseForm

**ファイル**: `packages/app/frontend/components/home/quick-expense-form.tsx`

- ホーム画面に埋め込む簡易支出登録フォーム
- カテゴリ・金額・名前のみ（日付は自動で今日）
- 登録成功時にフォームをリセット、カテゴリは保持（連続入力しやすい）

#### BudgetProgressBar

**ファイル**: `packages/app/frontend/components/home/budget-progress-bar.tsx`

- カテゴリ別の予算消化状況を視覚化
- プログレスバーの色で状態を表現：
  - 通常: プライマリカラー
  - 80%以上: 黄色
  - 100%超過: 赤

#### useHomeData

**ファイル**: `packages/app/frontend/hooks/use-home-data.tsx`

- ホーム画面用のデータ取得フック
- 以下を提供：
  - `internalBalance`: 全期間の内部残高
  - `thisMonthExpenseTotal`: 当月支出合計
  - `recentTransactions`: 最近の取引10件（UI上は5件表示）
  - `thisMonthBudgetProgress`: 予算消化状況（月次予算 = 年間 ÷ 12）

### 4. ランディングページの簡略化

**ファイル**: `packages/app/frontend/routes/index.tsx`

- アクセス時に自動的に `/dashboard` へリダイレクト
- 個人用アプリのため、ガイドページは不要と判断

---

## 期待される効果

### 1. 認知負荷の低減

**変更前**: 「どこを開けばいいんだっけ？」と迷う  
**変更後**: ホームを開けば必要な操作がすべて揃っている

### 2. 操作効率の向上

**支出登録の手順**:

- **変更前**: サイドバー「取引」→ 「取引を追加」ボタン → ダイアログ表示 → フォーム入力（5ステップ）
- **変更後**: ホームを開く → インラインフォームに入力（2ステップ）

### 3. 予算管理の可視化

**変更前**: 予算ページに行かないと予算との乖離が分からない  
**変更後**: ホームで常に当月の予算進捗が見える → 使いすぎに気づきやすい

### 4. 設計思想との整合性

**意思決定支援システム**としての本質を取り戻す：

- 日常操作がシンプルで自然
- 管理系操作は必要なときだけアクセス
- 重要な情報（残高・支出・予算）が常に見える

---

## 今後の展開

### 短期的な改善候補

1. **収入登録の簡易化**: 給料日にホームから収入を登録できるようにする
2. **予算アラート**: 予算の80%を超えたらホームに警告表示
3. **月次サマリ**: 月末にホームで当月の振り返りを表示

### 長期的な方向性

1. **適応型UI**: 利用パターンに応じてホームの表示内容を最適化
2. **クイックアクション**: よく使う操作をホームから直接実行できるショートカット
3. **予測機能**: 過去のパターンから予算超過リスクを事前通知

---

## 結論

今回の再設計により、financierは「すべての機能を並べた管理ツール」から「日常操作を中心とした意思決定支援システム」へと転換した。

**本質的な変化**:

- UIの起点が「ダッシュボード（中継点）」から「ホーム（操作の中心）」へ
- 情報構造が「フラット」から「利用頻度による階層化」へ
- 操作フローが「画面遷移中心」から「1画面完結」へ

これにより、ユーザーは**「今日やるべきこと」が明確で、迷わず操作できる**UIを手に入れた。
