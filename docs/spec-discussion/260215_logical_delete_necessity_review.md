# 260215 論理削除の必要性の検討（docs/spec）

## 対象

- `docs/spec/functions.md`
- `docs/spec/usecases.md`

## 変更方針（合意）

Category については「論理削除フラグ」を持たず、以下の方針へ統一する。

1. 利用停止は `status: active | archived` で表現する
2. `archived` は新規トランザクション登録・編集の選択肢から除外する
3. 既存トランザクション・予算の参照先としては保持する（履歴保全）
4. カテゴリ削除は物理削除とし、トランザクション参照 0 件の場合のみ許可する

## 背景

- カテゴリは広範な収支の定義であり、実運用で削除頻度は高くない
- 主要ニーズは「履歴を壊さず新規入力だけ止める」こと
- このニーズは論理削除よりも `status` による状態管理で直接的に表現できる

## 反映内容（functions）

- `docs/spec/functions.md` の Category 属性を `isActive` から `status: active | archived` へ変更
- Category 仕様に以下を追加
  - `archived` は新規トランザクション作成・編集時に選択不可
  - `archived` 指定でのトランザクション登録・更新は拒否
  - 既存データ参照は保持
  - カテゴリ削除は物理削除、かつトランザクション参照 0 件のみ許可

## 反映内容（usecases）

- `docs/spec/usecases.md` のカテゴリ関連ユースケースを `status` 管理ベースへ更新
  - UC-2.3 を「カテゴリのアーカイブ」に変更
  - 論理削除という文言を撤去
  - `status=archived` のカテゴリを新規入力で選択不可に統一
  - トランザクション参照 0 件の場合のみカテゴリ物理削除可能を明記

## 結論

- Category の退役手段は「論理削除」ではなく「`status` によるアーカイブ」を採用する
- 物理削除は未使用カテゴリ（トランザクション参照 0 件）に限定する
