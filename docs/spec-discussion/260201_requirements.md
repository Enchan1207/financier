# 260201 要求仕様書

個人向け年間収支管理システム（仮称）

## 1. 目的・概要

本システムは、単一ユーザが自身の年間収支を管理するための Web ベースの家計管理システムである。
日々の収支記録を主軸とし、年度単位での予算管理、カテゴリ別分析、積立状況の可視化を行うことを目的とする。

銀行連携や自動取得は行わず、手入力を前提とする。

## 2. 利用者・前提条件

- 利用者：単一ユーザ
- 利用形態：Web アプリケーション
- 通貨：日本円（JPY）固定
- データ保存：クラウド
- 外部連携：行わない
- エクスポート機能：対象外

## 3. 年度の定義

- 年度は **4月1日開始〜翌年3月31日終了**
- 年度は以下の状態を持つ

  - open：編集可能
  - closed：締め済み、完全固定

### 年度締め

- 年度締め操作を行うと、当該年度は closed 状態となる
- closed 状態の年度に属する以下のデータは **一切変更不可**
  - 収支取引
  - 予算
  - 繰越結果

## 4. カテゴリ管理

### 4.1 基本仕様

- カテゴリは年度非依存で共通
- 階層構造は持たない（フラット）
- ユーザによる追加・編集が可能
- 有効／無効の状態を持つ（論理削除）

### 4.2 カテゴリ種別

カテゴリは以下のいずれかの種別を持つ。

- 収入カテゴリ（income）
- 支出カテゴリ（expense）

### 4.3 支出カテゴリ固有属性

支出カテゴリのみ、以下の属性を持つ。

- 積立カテゴリフラグ
- （任意）積立目標金額
- （任意）積立開始日

収入カテゴリには積立関連の属性は存在しない。

## 5. 収支取引管理

### 5.1 支出取引

- 入力項目
  - 日付
  - 支出カテゴリ
  - 単価
  - 数量
- 金額は `単価 × 数量` で算出
- 登録直後の修正は想定される
- 前月以前の修正は原則行わない
- 年度が closed の場合、編集不可

### 5.2 収入取引

- 入力項目
  - 日付
  - 収入カテゴリ
  - 金額
- 数量は持たない
- 修正頻度は低い
- 年度が closed の場合、編集不可

## 6. 予算管理

### 6.1 予算の基本仕様

- 予算は **年度 × カテゴリ単位**で定義する
- 年額ベースで管理する
- 収入カテゴリ・支出カテゴリの双方に予算を設定できる

### 6.2 繰越

- 年度締め時に、カテゴリごとに以下を確定する
  - 実績
  - 予算との差分
  - 繰越額
- 繰越額は次年度の予算に反映される
- 繰越確定後は再計算しない

## 7. 積立管理

### 7.1 積立の定義

- 積立は **支出カテゴリの属性**として定義される
- 積立は独立した勘定を持たず、支出の一部である

### 7.2 積立金額の算出

- 積立累計額
  - 積立カテゴリに属する全期間の支出合計
- 年度別積立額
  - 対象年度内の積立カテゴリ支出合計

### 7.3 積立の表示

- 積立カテゴリごとに以下を表示する
  - 累計積立額
  - 年度内積立額
  - （目標がある場合）達成率
  - （期限がある場合）残期間

積立は年度締めの影響を受けず、累計は継続する。

## 8. 予算定義ヘルパ機能

### 8.1 目的

予算入力時の補助機能として提供する。

### 8.2 対応パターン

- 月額固定（×12）
- 月ごと変動（各月入力 → 年額合算）

### 8.3 非対応事項

- 実績からの自動算出
- 予算の自動調整

## 9. 表示・分析機能

### 9.1 円グラフ

- 年度単位で以下を表示
  - 収入カテゴリ構成比
  - 支出カテゴリ構成比
- 円グラフは **構成比のみ**を表す

### 9.2 棒グラフ

- カテゴリ別に以下を表示
  - 実績
  - 予算
  - 差分
- 年度単位・月次フィルタの両方に対応

### 9.3 一覧・サマリ

- 年度収支サマリ
- 積立進捗一覧
- カテゴリ別金額・割合・予算差分

## 10. 非機能要件

- Web アプリケーションとして提供
- クラウド上にデータを永続化
- 単一ユーザ前提のため、権限管理は最小限
- パフォーマンス要件は個人利用レベルを想定

## 11. スコープ外

- 銀行・クレジットカード連携
- CSV 等のエクスポート
- 複数ユーザ・家族共有
- 高度な予測・分析機能
